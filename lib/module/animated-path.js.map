{"version":3,"sources":["animated-path.js"],"names":["React","Component","InteractionManager","PropTypes","Path","interpolate","AnimatedPath","constructor","props","state","d","componentDidUpdate","newD","animate","oldD","interpolator","interpolatePath","_animate","componentWillUnmount","cancelAnimationFrame","animation","_clearInteraction","start","requestAnimationFrame","timestamp","handle","createInteractionHandle","delta","animationDuration","component","setNativeProps","setState","clearInteractionHandle","render","ref","propTypes","bool","number","renderPlaceholder","func","defaultProps"],"mappings":"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","sourcesContent":["import React, { Component } from 'react'\r\nimport { InteractionManager } from 'react-native'\r\nimport PropTypes from 'prop-types'\r\nimport { Path } from 'react-native-svg'\r\nimport * as interpolate from 'd3-interpolate-path'\r\n\r\nclass AnimatedPath extends Component {\r\n    constructor(props) {\r\n        super(props)\r\n\r\n        this.state = { d: props.d }\r\n    }\r\n\r\n    componentDidUpdate(props) {\r\n        const { d: newD, animate } = this.props\r\n        const { d: oldD } = props\r\n\r\n        this.newD = newD\r\n\r\n        if (newD === oldD) {\r\n            return\r\n        }\r\n\r\n        if (!animate || newD === null || oldD === null) {\r\n            return\r\n        }\r\n\r\n        this.newD = newD\r\n        this.interpolator = interpolate.interpolatePath(oldD, newD)\r\n\r\n        this._animate()\r\n    }\r\n\r\n    componentWillUnmount() {\r\n        cancelAnimationFrame(this.animation)\r\n        this._clearInteraction()\r\n    }\r\n\r\n    _animate(start) {\r\n        cancelAnimationFrame(this.animation)\r\n        this.animation = requestAnimationFrame((timestamp) => {\r\n            if (!start) {\r\n                this._clearInteraction()\r\n                this.handle = InteractionManager.createInteractionHandle()\r\n\r\n                start = timestamp\r\n            }\r\n\r\n            // Get the delta on how far long in our animation we are.\r\n            const delta = (timestamp - start) / this.props.animationDuration\r\n\r\n            // If we're above 1 then our animation should be complete.\r\n            if (delta > 1) {\r\n                // Just to be safe set our final value to the new graph path.\r\n                this.component.setNativeProps({ d: this.newD })\r\n                // Stop our animation loop.\r\n                this._clearInteraction()\r\n                return\r\n            }\r\n\r\n            const d = this.interpolator(delta)\r\n            this.component.setNativeProps({ d })\r\n            // console.log(this.interpolator)\r\n            // this.tween && console.log(this.tween.tween(delta))\r\n            // Tween the SVG path value according to what delta we're currently at.\r\n\r\n            // Update our state with the new tween value and then jump back into\r\n            // this loop.\r\n            this.setState(this.state, () => {\r\n                this._animate(start)\r\n            })\r\n        })\r\n    }\r\n\r\n    _clearInteraction() {\r\n        if (this.handle) {\r\n            InteractionManager.clearInteractionHandle(this.handle)\r\n            this.handle = null\r\n        }\r\n    }\r\n\r\n    render() {\r\n        return (\r\n            <Path\r\n                ref={(ref) => (this.component = ref)}\r\n                {...this.props}\r\n                d={this.props.animate ? this.state.d : this.props.d}\r\n            />\r\n        )\r\n    }\r\n}\r\n\r\nAnimatedPath.propTypes = {\r\n    animate: PropTypes.bool,\r\n    animationDuration: PropTypes.number,\r\n    renderPlaceholder: PropTypes.func,\r\n    ...Path.propTypes,\r\n}\r\n\r\nAnimatedPath.defaultProps = {\r\n    animate: false,\r\n    animationDuration: 300,\r\n    renderPlaceholder: () => null,\r\n}\r\n\r\nexport default AnimatedPath\r\n"]}