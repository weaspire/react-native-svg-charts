{"version":3,"sources":["bar-chart-grouped.js"],"names":["PropTypes","array","scale","shape","BarChart","GroupedBarChart","calcXScale","domain","horizontal","contentInset","left","right","spacingInner","spacingOuter","clamp","props","width","state","scaleLinear","range","scaleBand","paddingInner","paddingOuter","calcYScale","top","bottom","height","calcAreas","x","y","data","yAccessor","_data","map","obj","svg","item","value","areas","barWidth","bandwidth","length","forEach","collectionIndex","valueIndex","push","bar","path","area","_index","x0","x1","defined","y0","y1","calcExtent","gridMin","gridMax","dataExtent","merge","extent","yMin","yMax","calcIndexes","_","index","propTypes","arrayOf","isRequired","object"],"mappings":"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","sourcesContent":["import PropTypes from 'prop-types'\r\nimport * as array from 'd3-array'\r\nimport * as scale from 'd3-scale'\r\nimport * as shape from 'd3-shape'\r\nimport BarChart from './bar-chart'\r\n\r\nclass GroupedBarChart extends BarChart {\r\n    calcXScale(domain) {\r\n        const {\r\n            horizontal,\r\n            contentInset: { left = 0, right = 0 },\r\n            spacingInner,\r\n            spacingOuter,\r\n            clamp,\r\n        } = this.props\r\n\r\n        const { width } = this.state\r\n\r\n        if (horizontal) {\r\n            return scale\r\n                .scaleLinear()\r\n                .domain(domain)\r\n                .range([left, width - right])\r\n                .clamp(clamp)\r\n        }\r\n\r\n        return scale\r\n            .scaleBand()\r\n            .domain(domain)\r\n            .range([left, width - right])\r\n            .paddingInner([spacingInner])\r\n            .paddingOuter([spacingOuter])\r\n    }\r\n\r\n    calcYScale(domain) {\r\n        const {\r\n            horizontal,\r\n            spacingInner,\r\n            spacingOuter,\r\n            contentInset: { top = 0, bottom = 0 },\r\n            clamp,\r\n        } = this.props\r\n\r\n        const { height } = this.state\r\n\r\n        if (horizontal) {\r\n            return scale\r\n                .scaleBand()\r\n                .domain(domain)\r\n                .range([top, height - bottom])\r\n                .paddingInner([spacingInner])\r\n                .paddingOuter([spacingOuter])\r\n        }\r\n\r\n        return scale\r\n            .scaleLinear()\r\n            .domain(domain)\r\n            .range([height - bottom, top])\r\n            .clamp(clamp)\r\n    }\r\n\r\n    calcAreas(x, y) {\r\n        const { horizontal, data, yAccessor } = this.props\r\n\r\n        const _data = data.map((obj) => {\r\n            const { svg = {} } = obj\r\n            return {\r\n                ...obj,\r\n                data: obj.data.map((item) => {\r\n                    if (typeof item === 'number') {\r\n                        return {\r\n                            value: item,\r\n                            svg,\r\n                        }\r\n                    }\r\n\r\n                    return {\r\n                        ...item,\r\n                        svg: {\r\n                            ...svg,\r\n                            ...item.svg,\r\n                        },\r\n                        value: yAccessor({ item }),\r\n                    }\r\n                }),\r\n            }\r\n        })\r\n\r\n        const areas = []\r\n\r\n        if (horizontal) {\r\n            const barWidth = y.bandwidth() / data.length\r\n\r\n            _data.forEach((obj, collectionIndex) => {\r\n                obj.data.forEach((item, valueIndex) => {\r\n                    areas.push({\r\n                        bar: item,\r\n                        path: shape\r\n                            .area()\r\n                            .y((value, _index) =>\r\n                                _index === 0\r\n                                    ? y(valueIndex) + barWidth * collectionIndex\r\n                                    : y(valueIndex) + barWidth + barWidth * collectionIndex\r\n                            )\r\n                            .x0(x(0))\r\n                            .x1((value) => x(value))\r\n                            .defined((value) => typeof value === 'number')([item.value, item.value]),\r\n                    })\r\n                })\r\n            })\r\n        } else {\r\n            const barWidth = x.bandwidth() / data.length\r\n\r\n            _data.forEach((obj, collectionIndex) => {\r\n                obj.data.forEach((item, valueIndex) => {\r\n                    areas.push({\r\n                        bar: item,\r\n                        path: shape\r\n                            .area()\r\n                            .x((value, _index) =>\r\n                                _index === 0\r\n                                    ? x(valueIndex) + barWidth * collectionIndex\r\n                                    : x(valueIndex) + barWidth + barWidth * collectionIndex\r\n                            )\r\n                            .y0(y(0))\r\n                            .y1((value) => y(value))\r\n                            .defined((value) => typeof value === 'number')([item.value, item.value]),\r\n                    })\r\n                })\r\n            })\r\n        }\r\n\r\n        return areas\r\n    }\r\n\r\n    calcExtent() {\r\n        const { data, yAccessor, gridMin, gridMax } = this.props\r\n        const dataExtent = array.merge(data.map((obj) => obj.data.map((item) => yAccessor({ item }))))\r\n\r\n        const extent = array.extent([...dataExtent, gridMax, gridMin])\r\n\r\n        const { yMin = extent[0], yMax = extent[1] } = this.props\r\n\r\n        return [yMin, yMax]\r\n    }\r\n\r\n    calcIndexes() {\r\n        const { data } = this.props\r\n        return data[0].data.map((_, index) => index)\r\n    }\r\n}\r\n\r\nGroupedBarChart.propTypes = {\r\n    ...BarChart.propTypes,\r\n    data: PropTypes.arrayOf(\r\n        PropTypes.shape({\r\n            data: PropTypes.array.isRequired,\r\n            svg: PropTypes.object,\r\n        })\r\n    ).isRequired,\r\n}\r\n\r\nexport default GroupedBarChart\r\n"]}